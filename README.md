# My-Daily_Python

ä»¥[Daily](https://www.daily.co/)çš„Python SDKä¸ºåŸºï¼Œç›‘å¬[Tavus](https://www.tavus.io/)æœåŠ¡ä¸­äººç‰©ä¼šè¯ä¿¡æ¯ã€‚

- [My-Daily\_Python](#my-daily_python)
  - [Tavuså’ŒDailyç®€ä»‹ï¼š](#tavuså’Œdailyç®€ä»‹)
    - [Tavusä½“éªŒ:](#tavusä½“éªŒ)
  - [é¡¹ç›®å‰è¨€:](#é¡¹ç›®å‰è¨€)
    - [æµ‹è¯•è¿æ¥DailyæœåŠ¡:](#æµ‹è¯•è¿æ¥dailyæœåŠ¡)
  - [ç³»ç»Ÿé…ç½®ä¿¡æ¯:](#ç³»ç»Ÿé…ç½®ä¿¡æ¯)
  - [ä»£ç ç¯å¢ƒé…ç½®:](#ä»£ç ç¯å¢ƒé…ç½®)
    - [Condaç¯å¢ƒé…ç½®:](#condaç¯å¢ƒé…ç½®)
    - [ä¾èµ–é¡¹å®‰è£…:](#ä¾èµ–é¡¹å®‰è£…)
  - [ä¸»ç¨‹åºè¿è¡Œ:](#ä¸»ç¨‹åºè¿è¡Œ)
    - [1. åˆ›å»ºTavusä¼šè®®:](#1-åˆ›å»ºtavusä¼šè®®)
    - [2. æ ¹æ®conversation\_urlå…¥ä¼š:](#2-æ ¹æ®conversation_urlå…¥ä¼š)
    - [3. å¯åŠ¨websocketæœåŠ¡:](#3-å¯åŠ¨websocketæœåŠ¡)
    - [4. å»ºç«‹websocketè¿æ¥:](#4-å»ºç«‹websocketè¿æ¥)
  - [æ¥å£è¯¦è§£:](#æ¥å£è¯¦è§£)
    - [æ¥å£è°ƒç”¨å‰æ:](#æ¥å£è°ƒç”¨å‰æ)
    - [å¼€å§‹ç›‘å¬:](#å¼€å§‹ç›‘å¬)
    - [ç»“æŸç›‘å¬:](#ç»“æŸç›‘å¬)
    - [æ•°æ®è¿”å›æ ¼å¼:](#æ•°æ®è¿”å›æ ¼å¼)

## Tavuså’ŒDailyç®€ä»‹ï¼š

Tavus æ˜¯ä¸€ä¸ªä¸“æ³¨äº**ä¸ªæ€§åŒ–è§†é¢‘ç”Ÿæˆã€è™šæ‹Ÿäººäº¤äº’**çš„å¹³å°ã€‚

Daily æ˜¯ä¸€ä¸ª**å®æ—¶è§†é¢‘å’ŒéŸ³é¢‘é€šä¿¡**çš„ API æœåŠ¡æä¾›å•†ï¼Œç±»ä¼¼è…¾è®¯ä¼šè®®ã€‚ä¸è¿‡ï¼ŒDaily æ›´åŠ æ³¨é‡å¼€å‘è€…å‹å¥½å’ŒAPI æ¥å…¥ï¼Œè€Œè…¾è®¯ä¼šè®®åˆ™æ˜¯ä¸€ä¸ªé¢å‘ç»ˆç«¯ç”¨æˆ·çš„å®Œæ•´äº§å“ã€‚

Tavusç°å’ŒDailyåˆä½œï¼Œè™šæ‹ŸäººæœåŠ¡æ­å»ºåœ¨äº†Dailyä¼šè®®ä¸­ï¼Œç”¨æˆ·å¯åœ¨Dailyä¼šè®®ä¸­å’Œè™šæ‹Ÿäººå®æ—¶äº¤äº’ã€‚

### Tavusä½“éªŒ:

è¯»è€…å¯è¿è¡Œé¡¹ç›®æ ¹ç›®å½•çš„ `tavus` æ–‡ä»¶ä½“éªŒä¸€ä¸‹ä¸æ•°å­—äººäº¤äº’ã€‚æ“ä½œé¡ºåºå¦‚ä¸‹:

1. åˆ›å»ºTavusè´¦å·ï¼Œ[è·å–API-KEY](https://platform.tavus.io/api-keys)ã€‚

2. ç»ˆç«¯è¿è¡Œ `tavus_replica_create.py` é…ç½®tavusè™šæ‹Ÿäººè®¤çŸ¥èƒ½åŠ›ã€‚

3. ç»ˆç«¯è¿è¡Œ `tavus_conversation_create.py` åˆ›å»ºTavuså¯¹è¯ã€‚

ğŸš¨æ³¨æ„: è¯·è¯»è€…æ ¹æ®è‡ªèº«æƒ…å†µå†³å®šæ˜¯å¦å‡çº§TavusæœåŠ¡ï¼Œç¬”è€…ä½¿ç”¨Dailyã€Tavusä»…ç”¨äºç ”ç©¶/å­¦ä¹ ï¼Œä¸ä½œä»»ä½•æ¨èã€‚

æ¯•ç«Ÿï¼ŒTavusè¿˜æ˜¯æ¯”è¾ƒè´µçš„ã€‚å¦‚æœåªç”¨äºæµ‹è¯•ï¼Œå…è´¹ç‰ˆçš„ä¸‰åˆ†é’Ÿä¹Ÿè¶³å¤Ÿç”¨äº†ã€‚

![](./docs/tavus_plan.png)


## é¡¹ç›®å‰è¨€:

**ä»£ç ç¯å¢ƒ/æœåŠ¡å™¨** å¿…é¡»èƒ½ä»¥socket5å½¢å¼è¿æ¥åˆ°Dailyæ‰èƒ½è¿è¡Œç›‘å¬TavusæœåŠ¡ä¸­äººç‰©ä¼šè¯ä¿¡æ¯ã€‚

> ç¬”è€…ä¸ºäº†æ–¹ä¾¿ç›´æ¥ç§Ÿç”¨äº†AWSæœåŠ¡å™¨ï¼Œçœå»äº†é…ç½®ç§‘å­¦ä¸Šç½‘çš„åŠŸå¤«ï¼Œå¯ä»¥ç›´æ¥è¿æ¥åˆ°DailyæœåŠ¡ã€‚

### æµ‹è¯•è¿æ¥DailyæœåŠ¡:

æµ‹è¯•æ–¹æ³•å¾ˆç®€å•ï¼Œè¿è¡Œ `main.py` åæŸ¥çœ‹å…¥ä¼šæˆå‘˜æ˜¯å¦æœ‰ä»£ç ä¸­å®šä¹‰çš„ "listener" è§’è‰²å³å¯ã€‚

æ³¨æ„: å³ä½¿ä½ æ²¡æœ‰è¿æ¥åˆ°ä¼šè®®ï¼ŒDailyçš„ä»£ç ä¹Ÿä¸ä¼šæŠ¥é”™ã€‚ä¸æŠ¥é”™ï¼Œä¸ä»£è¡¨ä½ è¿æ¥åˆ°äº†Dailyä¼šè®®å®¤ã€‚


## ç³»ç»Ÿé…ç½®ä¿¡æ¯:

- æœåŠ¡å™¨: AWSæœåŠ¡å™¨ï¼Œæ”¯æŒè¿æ¥Dailyã€‚
- ç³»ç»Ÿ: ubuntu 24.04


## ä»£ç ç¯å¢ƒé…ç½®:

### Condaç¯å¢ƒé…ç½®:

```bash
conda create -n daily_py python==3.10.15
conda activate daily_py
```

### ä¾èµ–é¡¹å®‰è£…:

```bash
pip install -r requirements.txt
```


## ä¸»ç¨‹åºè¿è¡Œ:

### 1. åˆ›å»ºTavusä¼šè®®:

```bash
# åˆ›å»ºtavusä¼šè®®
python tavus_conversation_create.py
```

ç»ˆç«¯è¾“å‡º:

```json
{
    "conversation_id": "c7f4816e",
    "conversation_name": "\u65c5\u6e38\u52a9\u624b",
    "conversation_url": "https://tavus.daily.co/c7f4816e",
    "status": "active",
    "callback_url": null,
    "created_at": "2024-10-24T02:25:36.053Z"
}
```

### 2. æ ¹æ®conversation_urlå…¥ä¼š:

æ ¹æ® `conversation_url` å¯¹åº”çš„ç½‘å€å‚åŠ ä¼šè®®ï¼Œæ•ˆæœå¦‚ä¸‹:

![](./docs/tavuså…¥ä¼š.png)

![](./docs/å¸¸è§„å…¥ä¼š.jpg)

### 3. å¯åŠ¨websocketæœåŠ¡:

```bash
python main.py
```

### 4. å»ºç«‹websocketè¿æ¥:

é€šè¿‡Apifoxå»ºç«‹è¿æ¥ï¼Œå‘é€è¯·æ±‚è¿›è¡Œç›‘å¬ã€‚

![](./docs/apifoxç¤ºä¾‹.jpg)


## æ¥å£è¯¦è§£:

### æ¥å£è°ƒç”¨å‰æ:

1. åˆ›å»º tavus ä¼šè®®å¹¶å…¥ä¼šã€‚
2. ä¸ `ws://18.xxx.xxx:8000/ws` å»ºç«‹è¿æ¥ã€‚

### å¼€å§‹ç›‘å¬:

ä¼ å…¥tavusä¼šè®®çš„`conversation_id`è‡³wsé“¾æ¥ï¼Œæ­£å¼å¼€å§‹ç›‘å¬ **ä¼šè®®å®¤äººç‰©æ‰€è¯´æ–‡æœ¬ä¿¡æ¯**ã€‚ä¼ å…¥æ•°æ®ç±»å‹ä¸ºå­—ç¬¦ä¸²ï¼Œæ ¼å¼å¦‚ä¸‹:

```txt
conversation_id:c70ed8f4
```

å¼€å§‹ç›‘å¬åï¼Œä¸éœ€ä¼ å…¥ä»»ä½•å†…å®¹ï¼Œç¨‹åºä¼šè‡ªåŠ¨å›ä¼ æ•°æ®ã€‚æ³¨æ„ï¼štavusä¼šè®®ç»“æŸåï¼Œè®°å¾—**ç»“æŸç›‘å¬**ã€‚

### ç»“æŸç›‘å¬:

ä¼ å…¥å­—ç¬¦ä¸²ç»“æŸç›‘å¬ï¼Œæ ¼å¼å¦‚ä¸‹:

```txt
disconnect
```

### æ•°æ®è¿”å›æ ¼å¼:

é»˜è®¤è¿”å›å­—ç¬¦ä¸²å½¢å¼ï¼Œå‰ç«¯ä½¿ç”¨æ—¶å¯æ ¹æ®éœ€è¦è½¬æ¢ä¸ºjsonæ ¼å¼ã€‚

> tavusè¿”å›çš„ä¿¡æ¯**ä¸åŒºåˆ†å…·ä½“çš„è¯´è¯äºº**ï¼ŒåªåŒºåˆ†user(ç”¨æˆ·)å’Œreplica(è™šæ‹Ÿäºº)ã€‚ä¾‹å¦‚å¼ ä¸‰ã€æå››çš„roleç»Ÿä¸€ä¸ºuserã€‚

- user(ç”¨æˆ·):

```json
{
    "properties": {
        "role": "user",
        "speech": "å¤å¤©äº† å¤å¤©å¦‚ä½• "
    },
    "conversation_id": "c70ed8f4",
    "event_type": "conversation.utterance",
    // å¦‚æœå¼€å¯vqaï¼Œä¼šæœ‰è¿™ä¸ªå­—æ®µçš„æè¿°
    "visual_context": "The image shows a person wearing a purple shirt, looking down. The background is plain and light-colored.",
    "message_type": "conversation"
}
```

- replica(è™šæ‹Ÿäºº):

```json
{
    "conversation_id": "c70ed8f4",
    "message_type": "conversation",
    "properties": {
        "speech": "å¤å¤©çš„å¡å³°å²­è¿˜æ˜¯å¾ˆæ¼‚äº®çš„ï¼Œæ»¡å±±çš„é»„æ ŒèŠ±å¼€æ”¾ï¼Œæ™¯è‰²",
        "role": "replica"
    },
    "event_type": "conversation.utterance"
}
```

âš ï¸æ³¨æ„ï¼šreplicaä¼šå‡ºç°ä¾æ¬¡è¿”å›å¤šæ¡æ•°æ®çš„æƒ…å†µï¼Œreplica**è¯´çš„å†…å®¹**ä¼šä»¥åç»­è¿”å›çš„å†…å®¹è®²è¯ã€‚å»ºè®®å¦‚æœè¿ç»­å¤šä¸ªä¿¡æ¯æ˜¯åŒä¸€roleï¼Œç•Œé¢å±•ç¤ºæ—¶ï¼Œå°±é¡¶æ‰ä¹‹å‰çš„å†…å®¹ã€‚

```json
{
    "message_type": "conversation",
    "conversation_id": "c70ed8f4",
    "properties": {
        "role": "replica",
        "speech": "å¤å¤©çš„å¡å³°å²­ç»¿æ„ç›ç„¶ï¼Œæ°”æ¸©èˆ’é€‚ï¼Œæ˜¯ä¸ªæ”¾æ¾å¿ƒæƒ…ã€äº«å—è‡ªç„¶çš„å¥½å»å¤„ã€‚æ²¿é€”çš„å±±èŠ±ä¹Ÿä¼šç»™æ—…è¡Œå¢æ·»ä¸å°‘ä¹è¶£ã€‚ä½ è®¡åˆ’å¾…å¤šä¹…å‘¢ï¼Ÿ"
    },
    "event_type": "conversation.utterance"
}
```
